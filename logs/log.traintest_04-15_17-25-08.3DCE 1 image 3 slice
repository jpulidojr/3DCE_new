+ echo Logging output to '/home/pulido/CADLab/lesion_detector_3DCE/3DCE_new/./log.traintest_04-15_17-25-08.3DCE 1 image 3 slice'
Logging output to /home/pulido/CADLab/lesion_detector_3DCE/3DCE_new/./log.traintest_04-15_17-25-08.3DCE 1 image 3 slice
+ python /home/pulido/CADLab/lesion_detector_3DCE/3DCE_new/./rcnn/tools/train.py
/home/pulido/CADLab/lesion_detector_3DCE/3DCE_new/rcnn/tools/../../rcnn/config.py:176: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  yaml_cfg = edict(yaml.load(f))
INFO:root:{'ANCHOR_RATIOS': [0.5, 1, 2],
 'ANCHOR_SCALES': [2, 3, 4, 6, 12],
 'CLASS_NAMES': ['bg', 'lesion'],
 'FIXED_PARAMS': [],
 'FIXED_PARAMS_SHARED': ['conv1', 'conv2', 'conv3', 'conv4', 'conv5'],
 'FRAMEWORK': '3DCE',
 'GT_MARGIN': 0,
 'IMAGE_STRIDE': 0,
 'IMG_DO_CLIP': True,
 'MAX_SIZE': 512,
 'NORM_SPACING': 0.8,
 'NUM_ANCHORS': 15,
 'NUM_CLASSES': 2,
 'NUM_IMAGES_3DCE': 1,
 'NUM_SLICES': 3,
 'PIXEL_MEANS': array([50]),
 'RCNN_FEAT_STRIDE': 8,
 'RPN_FEAT_STRIDE': 8,
 'SCALE': 512,
 'SLICE_INTV': 2,
 'TEST': {'CXX_PROPOSAL': False,
          'HAS_RPN': False,
          'NMS': 0.3,
          'PROPOSAL_MIN_SIZE': 8,
          'PROPOSAL_NMS_THRESH': 0.7,
          'PROPOSAL_POST_NMS_TOP_N': 2000,
          'PROPOSAL_PRE_NMS_TOP_N': 20000,
          'RPN_MIN_SIZE': 8,
          'RPN_NMS_THRESH': 0.7,
          'RPN_POST_NMS_TOP_N': 300,
          'RPN_PRE_NMS_TOP_N': 6000,
          'SAMPLES_PER_BATCH': 1},
 'TRAIN': {'ASPECT_GROUPING': False,
           'BATCH_ROIS': 32,
           'BBOX_MEANS': [0.0, 0.0, 0.0, 0.0],
           'BBOX_NORMALIZATION_PRECOMPUTED': True,
           'BBOX_NORMALIZE_TARGETS': False,
           'BBOX_REGRESSION_THRESH': 0.5,
           'BBOX_STDS': [0.1, 0.1, 0.2, 0.2],
           'BBOX_WEIGHTS': array([1., 1., 1., 1.]),
           'BG_THRESH_HI': 0.5,
           'BG_THRESH_LO': 0.0,
           'CXX_PROPOSAL': False,
           'END2END': True,
           'FG_FRACTION': 0.25,
           'FG_THRESH': 0.5,
           'RCNN_POS_UPSAMPLE': False,
           'RCNN_REG_LOSS_WEIGHT': 10,
           'RPN_BATCH_SIZE': 32,
           'RPN_BBOX_WEIGHTS': [1.0, 1.0, 1.0, 1.0],
           'RPN_CLOBBER_POSITIVES': False,
           'RPN_FG_FRACTION': 0.5,
           'RPN_MIN_SIZE': 8,
           'RPN_NEGATIVE_OVERLAP': 0.3,
           'RPN_NMS_THRESH': 0.7,
           'RPN_POSITIVE_OVERLAP': 0.7,
           'RPN_POSITIVE_WEIGHT': -1.0,
           'RPN_POST_NMS_TOP_N': 2000,
           'RPN_PRE_NMS_TOP_N': 12000,
           'RPN_REG_LOSS_WEIGHT': 1,
           'SAMPLES_PER_BATCH': 1},
 'WINDOWING': [-1024, 3071]}
INFO:root:{'accs': {},
 'base_lr': 0.001,
 'begin_epoch': 0,
 'dataset': 'DeepLesion',
 'dataset_path': '/home/pulido/CADLab/lesion_detector_3DCE/images/',
 'e2e_epoch': 10,
 'e2e_lr': 0.001,
 'e2e_lr_step': '4,5',
 'e2e_prefix': 'model/3DCE 1 image 3 slice',
 'exp_name': '3DCE 1 image 3 slice',
 'flip': False,
 'frequent': 100,
 'gpus': '0',
 'groundtruth_file': '/home/pulido/CADLab/lesion_detector_3DCE/3DCE_new/data/DeepLesion/DL_info.csv',
 'image_path': '/home/pulido/CADLab/lesion_detector_3DCE/images/Images_png/',
 'image_set': 'train',
 'iter_size': 1,
 'keep_best_model': True,
 'kvstore': 'device',
 'lr_factor': 0.1,
 'network': 'vgg',
 'prefetch_thread_num': 4,
 'pretrained': '/home/pulido/CADLab/lesion_detector_3DCE/vgg16',
 'pretrained_epoch': 0,
 'proposal': 'rpn',
 'rand_seed': 23,
 'resume': False,
 'root_path': '/home/pulido/CADLab/lesion_detector_3DCE/3DCE_new/data',
 'show_avg_loss': 100,
 'shuffle': True,
 'test_image_set': 'test',
 'testing': False,
 'use_roidb_cache': True,
 'val_avg_fp': [0.5, 1, 2, 4, 8, 16],
 'val_gpu': '0',
 'val_has_rpn': True,
 'val_image_set': 'val',
 'val_iou_th': 0.5,
 'val_max_box': 5,
 'val_shuffle': False,
 'val_thresh': 0,
 'val_vis': False,
 'validate_at_begin': False,
 'weight_decay': 0.0005,
 'work_load_list': None}
INFO:root:DeepLesion_train num_images 22496
INFO:root:DeepLesion_train gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_train_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 22496 -> 22478, bboxes: 22919 -> 22901
INFO:root:sample boxes filtered, images: 22478 -> 2265, bboxes: 22901 -> 22901
INFO:root:Sampling 10 pcnt : 2265 training slices
INFO:root:Loading images with 4 threads.
INFO:root:providing maximum shape [('data', (1, 3, 512, 512)), ('gt_boxes', (1, 5, 5))] [('label', (1, 61440)), ('bbox_target', (1, 60, 64, 64)), ('bbox_weight', (1, 60, 64, 64))]
INFO:root:output shape {'bbox_loss_reshape_output': (1, 32, 8),
 'blockgrad0_output': (1, 32),
 'cls_prob_reshape_output': (1, 32, 2),
 'rpn_bbox_loss_output': (1, 60, 41, 42),
 'rpn_cls_prob_output': (1, 2, 615, 42)}
INFO:root:loading parameters from /home/pulido/CADLab/lesion_detector_3DCE/vgg16-0000.params
INFO:root:load param done
INFO:root:lr 0.001000 lr_epoch_diff [4.0, 5.0] lr_iters [9060, 11325]
INFO:root:Epoch 0 Batch 0	19972876.2 smp/sec	RPNLogLoss=0.683,	RPNL1Loss=0.00635,	RCNNLogLoss=0.694,	RCNNL1Loss=0.0286,	
INFO:root:Epoch 0 Batch 100	9.9 smp/sec	RPNLogLoss=0.322,	RPNL1Loss=0.0534,	RCNNLogLoss=0.42,	RCNNL1Loss=0.0404,	
INFO:root:Epoch 0 Batch 200	9.8 smp/sec	RPNLogLoss=0.162,	RPNL1Loss=0.0257,	RCNNLogLoss=0.363,	RCNNL1Loss=0.0591,	
INFO:root:Epoch 0 Batch 300	10.0 smp/sec	RPNLogLoss=0.149,	RPNL1Loss=0.0202,	RCNNLogLoss=0.418,	RCNNL1Loss=0.0909,	
INFO:root:Epoch 0 Batch 400	9.8 smp/sec	RPNLogLoss=0.218,	RPNL1Loss=0.0428,	RCNNLogLoss=0.399,	RCNNL1Loss=0.0675,	
INFO:root:Epoch 0 Batch 500	9.6 smp/sec	RPNLogLoss=0.164,	RPNL1Loss=0.0171,	RCNNLogLoss=0.399,	RCNNL1Loss=0.0754,	
INFO:root:Epoch 0 Batch 600	9.7 smp/sec	RPNLogLoss=0.161,	RPNL1Loss=0.0259,	RCNNLogLoss=0.409,	RCNNL1Loss=0.0826,	
INFO:root:Epoch 0 Batch 700	9.9 smp/sec	RPNLogLoss=0.18,	RPNL1Loss=0.0288,	RCNNLogLoss=0.393,	RCNNL1Loss=0.0781,	
INFO:root:Epoch 0 Batch 800	9.7 smp/sec	RPNLogLoss=0.157,	RPNL1Loss=0.027,	RCNNLogLoss=0.393,	RCNNL1Loss=0.0867,	
INFO:root:Epoch 0 Batch 900	10.0 smp/sec	RPNLogLoss=0.148,	RPNL1Loss=0.0187,	RCNNLogLoss=0.417,	RCNNL1Loss=0.102,	
INFO:root:Epoch 0 Batch 1000	10.1 smp/sec	RPNLogLoss=0.14,	RPNL1Loss=0.0141,	RCNNLogLoss=0.431,	RCNNL1Loss=0.0975,	
INFO:root:Epoch 0 Batch 1100	10.1 smp/sec	RPNLogLoss=0.156,	RPNL1Loss=0.0196,	RCNNLogLoss=0.431,	RCNNL1Loss=0.107,	
INFO:root:Epoch 0 Batch 1200	9.9 smp/sec	RPNLogLoss=0.163,	RPNL1Loss=0.0249,	RCNNLogLoss=0.428,	RCNNL1Loss=0.106,	
INFO:root:Epoch 0 Batch 1300	10.2 smp/sec	RPNLogLoss=0.151,	RPNL1Loss=0.0178,	RCNNLogLoss=0.405,	RCNNL1Loss=0.104,	
INFO:root:Epoch 0 Batch 1400	9.8 smp/sec	RPNLogLoss=0.142,	RPNL1Loss=0.0176,	RCNNLogLoss=0.386,	RCNNL1Loss=0.0975,	
INFO:root:Epoch 0 Batch 1500	9.7 smp/sec	RPNLogLoss=0.143,	RPNL1Loss=0.0209,	RCNNLogLoss=0.412,	RCNNL1Loss=0.107,	
INFO:root:Epoch 0 Batch 1600	9.9 smp/sec	RPNLogLoss=0.156,	RPNL1Loss=0.0197,	RCNNLogLoss=0.378,	RCNNL1Loss=0.0824,	
INFO:root:Epoch 0 Batch 1700	9.9 smp/sec	RPNLogLoss=0.137,	RPNL1Loss=0.016,	RCNNLogLoss=0.425,	RCNNL1Loss=0.108,	
INFO:root:Epoch 0 Batch 1800	9.7 smp/sec	RPNLogLoss=0.181,	RPNL1Loss=0.0371,	RCNNLogLoss=0.399,	RCNNL1Loss=0.118,	
INFO:root:Epoch 0 Batch 1900	9.8 smp/sec	RPNLogLoss=0.117,	RPNL1Loss=0.0116,	RCNNLogLoss=0.407,	RCNNL1Loss=0.113,	
INFO:root:Epoch 0 Batch 2000	9.7 smp/sec	RPNLogLoss=0.174,	RPNL1Loss=0.0639,	RCNNLogLoss=0.382,	RCNNL1Loss=0.0981,	
INFO:root:Epoch 0 Batch 2100	10.0 smp/sec	RPNLogLoss=0.13,	RPNL1Loss=0.017,	RCNNLogLoss=0.394,	RCNNL1Loss=0.104,	
INFO:root:Epoch 0 Batch 2200	9.8 smp/sec	RPNLogLoss=0.143,	RPNL1Loss=0.0183,	RCNNLogLoss=0.394,	RCNNL1Loss=0.134,	
INFO:root:Epoch[0] Train-RPNLogLoss=0.153515
INFO:root:Epoch[0] Train-RPNL1Loss=0.020569
INFO:root:Epoch[0] Train-RCNNLogLoss=0.420369
INFO:root:Epoch[0] Train-RCNNL1Loss=0.122130
INFO:root:Epoch[0] Time cost=229.860
INFO:root:Saved checkpoint to "model/3DCE 1 image 3 slice-0001.params"
INFO:root:Validating ...
INFO:root:DeepLesion_val num_images 4793
INFO:root:DeepLesion_val gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_val_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 4793 -> 4791, bboxes: 4889 -> 4887
INFO:root:Loading images with 4 threads.
INFO:root:loading parameters from model/3DCE 1 image 3 slice-0001.params
INFO:root:im_detect: 0/4791 data 0.003s im_detect 0.076s misc 0.004s
INFO:root:im_detect: 200/4791 data 0.006s im_detect 0.054s misc 0.003s
INFO:root:im_detect: 400/4791 data 0.006s im_detect 0.052s misc 0.003s
600 800 1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000 3200 3400 3600 3800 4000 4200 4400 4600
Sensitivity @ [0.5, 1, 2, 4, 8, 16] average FPs per image: [0.07325558 0.10394925 0.14876202 0.19418866 0.24616329 0.32617148]
Iter 1: 0.1942
INFO:root:Validate callback: 0.194189
INFO:root:Returned Validation=0.194189
INFO:root:Retraining data=0.194189
INFO:root:Loading images with 4 threads.
INFO:root:Redoing training to meet criteria = 1
INFO:root:sample boxes filtered, images: 22478 -> 2264, bboxes: 22901 -> 22901
INFO:root:Loading images with 4 threads.
INFO:root:Epoch 1 Batch 0	0.3 smp/sec	RPNLogLoss=0.152,	RPNL1Loss=0.0203,	RCNNLogLoss=0.419,	RCNNL1Loss=0.12,	
INFO:root:Epoch 1 Batch 100	9.7 smp/sec	RPNLogLoss=0.132,	RPNL1Loss=0.0145,	RCNNLogLoss=0.403,	RCNNL1Loss=0.126,	
INFO:root:Epoch 1 Batch 200	9.7 smp/sec	RPNLogLoss=0.105,	RPNL1Loss=0.0137,	RCNNLogLoss=0.425,	RCNNL1Loss=0.135,	
INFO:root:Epoch 1 Batch 300	9.4 smp/sec	RPNLogLoss=0.131,	RPNL1Loss=0.0187,	RCNNLogLoss=0.37,	RCNNL1Loss=0.119,	
INFO:root:Epoch 1 Batch 400	9.5 smp/sec	RPNLogLoss=0.0983,	RPNL1Loss=0.0132,	RCNNLogLoss=0.374,	RCNNL1Loss=0.134,	
INFO:root:Epoch 1 Batch 500	9.3 smp/sec	RPNLogLoss=0.118,	RPNL1Loss=0.0192,	RCNNLogLoss=0.367,	RCNNL1Loss=0.115,	
INFO:root:Epoch 1 Batch 600	9.2 smp/sec	RPNLogLoss=0.111,	RPNL1Loss=0.0197,	RCNNLogLoss=0.394,	RCNNL1Loss=0.107,	
INFO:root:Epoch 1 Batch 700	9.8 smp/sec	RPNLogLoss=0.149,	RPNL1Loss=0.0289,	RCNNLogLoss=0.348,	RCNNL1Loss=0.104,	
INFO:root:Epoch 1 Batch 800	9.6 smp/sec	RPNLogLoss=0.113,	RPNL1Loss=0.0215,	RCNNLogLoss=0.349,	RCNNL1Loss=0.109,	
INFO:root:Epoch 1 Batch 900	9.3 smp/sec	RPNLogLoss=0.124,	RPNL1Loss=0.023,	RCNNLogLoss=0.369,	RCNNL1Loss=0.114,	
INFO:root:Epoch 1 Batch 1000	9.5 smp/sec	RPNLogLoss=0.131,	RPNL1Loss=0.0234,	RCNNLogLoss=0.404,	RCNNL1Loss=0.127,	
INFO:root:Epoch 1 Batch 1100	9.7 smp/sec	RPNLogLoss=0.113,	RPNL1Loss=0.0226,	RCNNLogLoss=0.357,	RCNNL1Loss=0.112,	
INFO:root:Epoch 1 Batch 1200	9.7 smp/sec	RPNLogLoss=0.113,	RPNL1Loss=0.0254,	RCNNLogLoss=0.365,	RCNNL1Loss=0.104,	
INFO:root:Epoch 1 Batch 1300	9.6 smp/sec	RPNLogLoss=0.0962,	RPNL1Loss=0.0161,	RCNNLogLoss=0.349,	RCNNL1Loss=0.116,	
INFO:root:Epoch 1 Batch 1400	9.7 smp/sec	RPNLogLoss=0.111,	RPNL1Loss=0.0232,	RCNNLogLoss=0.35,	RCNNL1Loss=0.101,	
INFO:root:Epoch 1 Batch 1500	9.8 smp/sec	RPNLogLoss=0.12,	RPNL1Loss=0.032,	RCNNLogLoss=0.38,	RCNNL1Loss=0.109,	
INFO:root:Epoch 1 Batch 1600	9.8 smp/sec	RPNLogLoss=0.117,	RPNL1Loss=0.0184,	RCNNLogLoss=0.371,	RCNNL1Loss=0.133,	
INFO:root:Epoch 1 Batch 1700	9.7 smp/sec	RPNLogLoss=0.12,	RPNL1Loss=0.0123,	RCNNLogLoss=0.382,	RCNNL1Loss=0.117,	
INFO:root:Epoch 1 Batch 1800	9.6 smp/sec	RPNLogLoss=0.0989,	RPNL1Loss=0.0149,	RCNNLogLoss=0.329,	RCNNL1Loss=0.103,	
INFO:root:Epoch 1 Batch 1900	9.7 smp/sec	RPNLogLoss=0.0893,	RPNL1Loss=0.012,	RCNNLogLoss=0.351,	RCNNL1Loss=0.099,	
INFO:root:Epoch 1 Batch 2000	9.7 smp/sec	RPNLogLoss=0.105,	RPNL1Loss=0.0187,	RCNNLogLoss=0.311,	RCNNL1Loss=0.107,	
INFO:root:Epoch 1 Batch 2100	10.1 smp/sec	RPNLogLoss=0.0922,	RPNL1Loss=0.0129,	RCNNLogLoss=0.355,	RCNNL1Loss=0.122,	
INFO:root:Epoch 1 Batch 2200	9.5 smp/sec	RPNLogLoss=0.112,	RPNL1Loss=0.0187,	RCNNLogLoss=0.357,	RCNNL1Loss=0.0991,	
INFO:root:Epoch[1] Train-RPNLogLoss=0.091063
INFO:root:Epoch[1] Train-RPNL1Loss=0.013117
INFO:root:Epoch[1] Train-RCNNLogLoss=0.336404
INFO:root:Epoch[1] Train-RCNNL1Loss=0.101176
INFO:root:Epoch[1] Time cost=236.111
INFO:root:Saved checkpoint to "model/3DCE 1 image 3 slice-0002.params"
INFO:root:Validating ...
INFO:root:DeepLesion_val num_images 4793
INFO:root:DeepLesion_val gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_val_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 4793 -> 4791, bboxes: 4889 -> 4887
INFO:root:Loading images with 4 threads.
INFO:root:loading parameters from model/3DCE 1 image 3 slice-0002.params
INFO:root:im_detect: 0/4791 data 0.077s im_detect 0.062s misc 0.004s
INFO:root:im_detect: 200/4791 data 0.009s im_detect 0.046s misc 0.003s
INFO:root:im_detect: 400/4791 data 0.008s im_detect 0.046s misc 0.003s
600 800 1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000 3200 3400 3600 3800 4000 4200 4400 4600
Sensitivity @ [0.5, 1, 2, 4, 8, 16] average FPs per image: [0.1702476  0.24718641 0.33988132 0.42746061 0.51851852 0.6009822 ]
Iter 1: 0.1942
Iter 2: 0.4275
model/3DCE 1 image 3 slice-0001.params deleted to keep only the best model
INFO:root:Validate callback: 0.427461
INFO:root:Returned Validation=0.427461
INFO:root:Retraining data=0.427461
INFO:root:Loading images with 4 threads.
INFO:root:Redoing training to meet criteria = 2
INFO:root:sample boxes filtered, images: 22478 -> 2222, bboxes: 22901 -> 22901
INFO:root:Loading images with 4 threads.
INFO:root:Epoch 2 Batch 0	0.3 smp/sec	RPNLogLoss=0.09,	RPNL1Loss=0.0131,	RCNNLogLoss=0.336,	RCNNL1Loss=0.103,	
INFO:root:Epoch 2 Batch 100	9.4 smp/sec	RPNLogLoss=0.112,	RPNL1Loss=0.0234,	RCNNLogLoss=0.342,	RCNNL1Loss=0.109,	
INFO:root:Epoch 2 Batch 200	10.0 smp/sec	RPNLogLoss=0.101,	RPNL1Loss=0.0151,	RCNNLogLoss=0.321,	RCNNL1Loss=0.1,	
INFO:root:Epoch 2 Batch 300	9.6 smp/sec	RPNLogLoss=0.0794,	RPNL1Loss=0.0114,	RCNNLogLoss=0.311,	RCNNL1Loss=0.0929,	
INFO:root:Epoch 2 Batch 400	9.5 smp/sec	RPNLogLoss=0.089,	RPNL1Loss=0.0137,	RCNNLogLoss=0.327,	RCNNL1Loss=0.0982,	
INFO:root:Epoch 2 Batch 500	9.4 smp/sec	RPNLogLoss=0.107,	RPNL1Loss=0.0198,	RCNNLogLoss=0.372,	RCNNL1Loss=0.111,	
INFO:root:Epoch 2 Batch 600	9.7 smp/sec	RPNLogLoss=0.101,	RPNL1Loss=0.0128,	RCNNLogLoss=0.336,	RCNNL1Loss=0.091,	
INFO:root:Epoch 2 Batch 700	9.6 smp/sec	RPNLogLoss=0.0767,	RPNL1Loss=0.0156,	RCNNLogLoss=0.322,	RCNNL1Loss=0.0932,	
INFO:root:Epoch 2 Batch 800	9.5 smp/sec	RPNLogLoss=0.112,	RPNL1Loss=0.0143,	RCNNLogLoss=0.36,	RCNNL1Loss=0.103,	
INFO:root:Epoch 2 Batch 900	10.0 smp/sec	RPNLogLoss=0.0815,	RPNL1Loss=0.0128,	RCNNLogLoss=0.335,	RCNNL1Loss=0.103,	
INFO:root:Epoch 2 Batch 1000	9.6 smp/sec	RPNLogLoss=0.0979,	RPNL1Loss=0.0183,	RCNNLogLoss=0.316,	RCNNL1Loss=0.0971,	
INFO:root:Epoch 2 Batch 1100	9.4 smp/sec	RPNLogLoss=0.106,	RPNL1Loss=0.0194,	RCNNLogLoss=0.344,	RCNNL1Loss=0.103,	
INFO:root:Epoch 2 Batch 1200	9.8 smp/sec	RPNLogLoss=0.172,	RPNL1Loss=0.0358,	RCNNLogLoss=0.351,	RCNNL1Loss=0.105,	
INFO:root:Epoch 2 Batch 1300	9.5 smp/sec	RPNLogLoss=0.0988,	RPNL1Loss=0.0191,	RCNNLogLoss=0.352,	RCNNL1Loss=0.103,	
INFO:root:Epoch 2 Batch 1400	9.7 smp/sec	RPNLogLoss=0.0933,	RPNL1Loss=0.0263,	RCNNLogLoss=0.319,	RCNNL1Loss=0.0954,	
INFO:root:Epoch 2 Batch 1500	9.6 smp/sec	RPNLogLoss=0.0753,	RPNL1Loss=0.0109,	RCNNLogLoss=0.305,	RCNNL1Loss=0.0915,	
INFO:root:Epoch 2 Batch 1600	9.5 smp/sec	RPNLogLoss=0.0776,	RPNL1Loss=0.0109,	RCNNLogLoss=0.36,	RCNNL1Loss=0.0999,	
INFO:root:Epoch 2 Batch 1700	9.7 smp/sec	RPNLogLoss=0.0863,	RPNL1Loss=0.0179,	RCNNLogLoss=0.299,	RCNNL1Loss=0.101,	
INFO:root:Epoch 2 Batch 1800	9.6 smp/sec	RPNLogLoss=0.0797,	RPNL1Loss=0.0136,	RCNNLogLoss=0.334,	RCNNL1Loss=0.091,	
INFO:root:Epoch 2 Batch 1900	9.5 smp/sec	RPNLogLoss=0.0885,	RPNL1Loss=0.0313,	RCNNLogLoss=0.306,	RCNNL1Loss=0.0979,	
INFO:root:Epoch 2 Batch 2000	9.4 smp/sec	RPNLogLoss=0.0776,	RPNL1Loss=0.0111,	RCNNLogLoss=0.265,	RCNNL1Loss=0.0782,	
INFO:root:Epoch 2 Batch 2100	9.6 smp/sec	RPNLogLoss=0.0743,	RPNL1Loss=0.0128,	RCNNLogLoss=0.311,	RCNNL1Loss=0.0921,	
INFO:root:Epoch 2 Batch 2200	9.8 smp/sec	RPNLogLoss=0.087,	RPNL1Loss=0.0213,	RCNNLogLoss=0.335,	RCNNL1Loss=0.103,	
INFO:root:Epoch[2] Train-RPNLogLoss=0.070105
INFO:root:Epoch[2] Train-RPNL1Loss=0.014670
INFO:root:Epoch[2] Train-RCNNLogLoss=0.330215
INFO:root:Epoch[2] Train-RCNNL1Loss=0.103414
INFO:root:Epoch[2] Time cost=231.853
INFO:root:Saved checkpoint to "model/3DCE 1 image 3 slice-0003.params"
INFO:root:Validating ...
INFO:root:DeepLesion_val num_images 4793
INFO:root:DeepLesion_val gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_val_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 4793 -> 4791, bboxes: 4889 -> 4887
INFO:root:Loading images with 4 threads.
INFO:root:loading parameters from model/3DCE 1 image 3 slice-0003.params
INFO:root:im_detect: 0/4791 data 0.074s im_detect 0.087s misc 0.003s
INFO:root:im_detect: 200/4791 data 0.008s im_detect 0.048s misc 0.003s
INFO:root:im_detect: 400/4791 data 0.006s im_detect 0.046s misc 0.003s
600 800 1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000 3200 3400 3600 3800 4000 4200 4400 4600
Sensitivity @ [0.5, 1, 2, 4, 8, 16] average FPs per image: [0.26396562 0.34520156 0.44014733 0.53038674 0.62062615 0.70063434]
Iter 1: 0.1942
Iter 2: 0.4275
Iter 3: 0.5304
model/3DCE 1 image 3 slice-0002.params deleted to keep only the best model
INFO:root:Validate callback: 0.530387
INFO:root:Returned Validation=0.530387
INFO:root:Retraining data=0.530387
INFO:root:Loading images with 4 threads.
INFO:root:Redoing training to meet criteria = 3
INFO:root:sample boxes filtered, images: 22478 -> 2258, bboxes: 22901 -> 22901
INFO:root:Loading images with 4 threads.
INFO:root:Epoch 3 Batch 0	0.4 smp/sec	RPNLogLoss=0.0721,	RPNL1Loss=0.0148,	RCNNLogLoss=0.334,	RCNNL1Loss=0.105,	
INFO:root:Epoch 3 Batch 100	9.5 smp/sec	RPNLogLoss=0.08,	RPNL1Loss=0.0121,	RCNNLogLoss=0.331,	RCNNL1Loss=0.0971,	
INFO:root:Epoch 3 Batch 200	9.5 smp/sec	RPNLogLoss=0.0856,	RPNL1Loss=0.0143,	RCNNLogLoss=0.337,	RCNNL1Loss=0.0918,	
INFO:root:Epoch 3 Batch 300	9.7 smp/sec	RPNLogLoss=0.0783,	RPNL1Loss=0.0153,	RCNNLogLoss=0.307,	RCNNL1Loss=0.0981,	
INFO:root:Epoch 3 Batch 400	9.6 smp/sec	RPNLogLoss=0.0702,	RPNL1Loss=0.0127,	RCNNLogLoss=0.31,	RCNNL1Loss=0.0797,	
INFO:root:Epoch 3 Batch 500	9.6 smp/sec	RPNLogLoss=0.0815,	RPNL1Loss=0.0119,	RCNNLogLoss=0.286,	RCNNL1Loss=0.0822,	
INFO:root:Epoch 3 Batch 600	9.6 smp/sec	RPNLogLoss=0.0785,	RPNL1Loss=0.0167,	RCNNLogLoss=0.324,	RCNNL1Loss=0.0956,	
INFO:root:Epoch 3 Batch 700	9.6 smp/sec	RPNLogLoss=0.0573,	RPNL1Loss=0.0163,	RCNNLogLoss=0.285,	RCNNL1Loss=0.0942,	
INFO:root:Epoch 3 Batch 800	9.5 smp/sec	RPNLogLoss=0.0732,	RPNL1Loss=0.012,	RCNNLogLoss=0.291,	RCNNL1Loss=0.092,	
INFO:root:Epoch 3 Batch 900	9.6 smp/sec	RPNLogLoss=0.0746,	RPNL1Loss=0.0158,	RCNNLogLoss=0.313,	RCNNL1Loss=0.0941,	
INFO:root:Epoch 3 Batch 1000	9.5 smp/sec	RPNLogLoss=0.0528,	RPNL1Loss=0.0112,	RCNNLogLoss=0.296,	RCNNL1Loss=0.0942,	
INFO:root:Epoch 3 Batch 1100	9.7 smp/sec	RPNLogLoss=0.0871,	RPNL1Loss=0.0189,	RCNNLogLoss=0.35,	RCNNL1Loss=0.0927,	
INFO:root:Epoch 3 Batch 1200	9.5 smp/sec	RPNLogLoss=0.0708,	RPNL1Loss=0.0122,	RCNNLogLoss=0.343,	RCNNL1Loss=0.105,	
INFO:root:Epoch 3 Batch 1300	9.6 smp/sec	RPNLogLoss=0.0898,	RPNL1Loss=0.0172,	RCNNLogLoss=0.305,	RCNNL1Loss=0.0948,	
INFO:root:Epoch 3 Batch 1400	9.6 smp/sec	RPNLogLoss=0.0637,	RPNL1Loss=0.013,	RCNNLogLoss=0.308,	RCNNL1Loss=0.0865,	
INFO:root:Epoch 3 Batch 1500	9.9 smp/sec	RPNLogLoss=0.0727,	RPNL1Loss=0.013,	RCNNLogLoss=0.322,	RCNNL1Loss=0.0917,	
INFO:root:Epoch 3 Batch 1600	9.9 smp/sec	RPNLogLoss=0.0694,	RPNL1Loss=0.0121,	RCNNLogLoss=0.313,	RCNNL1Loss=0.0864,	
INFO:root:Epoch 3 Batch 1700	9.7 smp/sec	RPNLogLoss=0.0929,	RPNL1Loss=0.0155,	RCNNLogLoss=0.33,	RCNNL1Loss=0.095,	
INFO:root:Epoch 3 Batch 1800	9.7 smp/sec	RPNLogLoss=0.0771,	RPNL1Loss=0.0137,	RCNNLogLoss=0.344,	RCNNL1Loss=0.095,	
INFO:root:Epoch 3 Batch 1900	9.5 smp/sec	RPNLogLoss=0.0866,	RPNL1Loss=0.0169,	RCNNLogLoss=0.288,	RCNNL1Loss=0.0866,	
INFO:root:Epoch 3 Batch 2000	9.6 smp/sec	RPNLogLoss=0.068,	RPNL1Loss=0.0129,	RCNNLogLoss=0.29,	RCNNL1Loss=0.084,	
INFO:root:Epoch 3 Batch 2100	9.9 smp/sec	RPNLogLoss=0.0832,	RPNL1Loss=0.0172,	RCNNLogLoss=0.338,	RCNNL1Loss=0.0938,	
INFO:root:Epoch 3 Batch 2200	9.7 smp/sec	RPNLogLoss=0.086,	RPNL1Loss=0.0181,	RCNNLogLoss=0.342,	RCNNL1Loss=0.109,	
INFO:root:Epoch[3] Train-RPNLogLoss=0.057993
INFO:root:Epoch[3] Train-RPNL1Loss=0.015915
INFO:root:Epoch[3] Train-RCNNLogLoss=0.316527
INFO:root:Epoch[3] Train-RCNNL1Loss=0.094536
INFO:root:Epoch[3] Time cost=235.019
INFO:root:Saved checkpoint to "model/3DCE 1 image 3 slice-0004.params"
INFO:root:Validating ...
INFO:root:DeepLesion_val num_images 4793
INFO:root:DeepLesion_val gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_val_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 4793 -> 4791, bboxes: 4889 -> 4887
INFO:root:Loading images with 4 threads.
INFO:root:loading parameters from model/3DCE 1 image 3 slice-0004.params
INFO:root:im_detect: 0/4791 data 0.023s im_detect 0.076s misc 0.003s
INFO:root:im_detect: 200/4791 data 0.009s im_detect 0.047s misc 0.003s
INFO:root:im_detect: 400/4791 data 0.009s im_detect 0.046s misc 0.003s
600 800 1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000 3200 3400 3600 3800 4000 4200 4400 4600
Sensitivity @ [0.5, 1, 2, 4, 8, 16] average FPs per image: [0.26151013 0.35543278 0.45447105 0.55064457 0.64906896 0.72559853]
Iter 1: 0.1942
Iter 2: 0.4275
Iter 3: 0.5304
Iter 4: 0.5506
model/3DCE 1 image 3 slice-0003.params deleted to keep only the best model
INFO:root:Validate callback: 0.550645
INFO:root:Returned Validation=0.550645
INFO:root:Retraining data=0.550645
INFO:root:Loading images with 4 threads.
INFO:root:Redoing training to meet criteria = 4
INFO:root:sample boxes filtered, images: 22478 -> 2230, bboxes: 22901 -> 22901
INFO:root:Loading images with 4 threads.
INFO:root:Epoch 4 Batch 0	0.3 smp/sec	RPNLogLoss=0.0574,	RPNL1Loss=0.0157,	RCNNLogLoss=0.316,	RCNNL1Loss=0.0939,	
INFO:root:Update[9061]: Change learning rate to 1.00000e-04
INFO:root:Epoch 4 Batch 100	9.5 smp/sec	RPNLogLoss=0.0886,	RPNL1Loss=0.0223,	RCNNLogLoss=0.33,	RCNNL1Loss=0.0935,	
INFO:root:Epoch 4 Batch 200	9.4 smp/sec	RPNLogLoss=0.0582,	RPNL1Loss=0.0109,	RCNNLogLoss=0.289,	RCNNL1Loss=0.0782,	
INFO:root:Epoch 4 Batch 300	9.8 smp/sec	RPNLogLoss=0.0601,	RPNL1Loss=0.0128,	RCNNLogLoss=0.272,	RCNNL1Loss=0.083,	
INFO:root:Epoch 4 Batch 400	9.8 smp/sec	RPNLogLoss=0.0616,	RPNL1Loss=0.0169,	RCNNLogLoss=0.282,	RCNNL1Loss=0.0746,	
INFO:root:Epoch 4 Batch 500	9.7 smp/sec	RPNLogLoss=0.0615,	RPNL1Loss=0.0115,	RCNNLogLoss=0.288,	RCNNL1Loss=0.0761,	
INFO:root:Epoch 4 Batch 600	9.6 smp/sec	RPNLogLoss=0.0619,	RPNL1Loss=0.0155,	RCNNLogLoss=0.25,	RCNNL1Loss=0.0796,	
INFO:root:Epoch 4 Batch 700	9.8 smp/sec	RPNLogLoss=0.0523,	RPNL1Loss=0.00935,	RCNNLogLoss=0.226,	RCNNL1Loss=0.0725,	
INFO:root:Epoch 4 Batch 800	9.7 smp/sec	RPNLogLoss=0.0619,	RPNL1Loss=0.0142,	RCNNLogLoss=0.277,	RCNNL1Loss=0.0743,	
INFO:root:Epoch 4 Batch 900	9.5 smp/sec	RPNLogLoss=0.0693,	RPNL1Loss=0.0139,	RCNNLogLoss=0.287,	RCNNL1Loss=0.0769,	
INFO:root:Epoch 4 Batch 1000	9.7 smp/sec	RPNLogLoss=0.0469,	RPNL1Loss=0.0158,	RCNNLogLoss=0.253,	RCNNL1Loss=0.0776,	
INFO:root:Epoch 4 Batch 1100	9.8 smp/sec	RPNLogLoss=0.0652,	RPNL1Loss=0.0114,	RCNNLogLoss=0.272,	RCNNL1Loss=0.0813,	
INFO:root:Epoch 4 Batch 1200	9.6 smp/sec	RPNLogLoss=0.0604,	RPNL1Loss=0.0104,	RCNNLogLoss=0.258,	RCNNL1Loss=0.0804,	
INFO:root:Epoch 4 Batch 1300	9.7 smp/sec	RPNLogLoss=0.0517,	RPNL1Loss=0.0157,	RCNNLogLoss=0.24,	RCNNL1Loss=0.0778,	
INFO:root:Epoch 4 Batch 1400	9.8 smp/sec	RPNLogLoss=0.0553,	RPNL1Loss=0.0102,	RCNNLogLoss=0.279,	RCNNL1Loss=0.0815,	
INFO:root:Epoch 4 Batch 1500	9.6 smp/sec	RPNLogLoss=0.057,	RPNL1Loss=0.0104,	RCNNLogLoss=0.254,	RCNNL1Loss=0.079,	
INFO:root:Epoch 4 Batch 1600	9.3 smp/sec	RPNLogLoss=0.0424,	RPNL1Loss=0.00897,	RCNNLogLoss=0.24,	RCNNL1Loss=0.0791,	
INFO:root:Epoch 4 Batch 1700	9.5 smp/sec	RPNLogLoss=0.056,	RPNL1Loss=0.0105,	RCNNLogLoss=0.257,	RCNNL1Loss=0.076,	
INFO:root:Epoch 4 Batch 1800	9.8 smp/sec	RPNLogLoss=0.0638,	RPNL1Loss=0.0136,	RCNNLogLoss=0.233,	RCNNL1Loss=0.0696,	
INFO:root:Epoch 4 Batch 1900	9.7 smp/sec	RPNLogLoss=0.0902,	RPNL1Loss=0.0226,	RCNNLogLoss=0.272,	RCNNL1Loss=0.0788,	
INFO:root:Epoch 4 Batch 2000	9.7 smp/sec	RPNLogLoss=0.069,	RPNL1Loss=0.00735,	RCNNLogLoss=0.28,	RCNNL1Loss=0.0856,	
INFO:root:Epoch 4 Batch 2100	9.8 smp/sec	RPNLogLoss=0.0481,	RPNL1Loss=0.00683,	RCNNLogLoss=0.234,	RCNNL1Loss=0.0779,	
INFO:root:Epoch 4 Batch 2200	9.7 smp/sec	RPNLogLoss=0.0553,	RPNL1Loss=0.0084,	RCNNLogLoss=0.267,	RCNNL1Loss=0.0733,	
INFO:root:Epoch[4] Train-RPNLogLoss=0.050144
INFO:root:Epoch[4] Train-RPNL1Loss=0.007498
INFO:root:Epoch[4] Train-RCNNLogLoss=0.250018
INFO:root:Epoch[4] Train-RCNNL1Loss=0.071434
INFO:root:Epoch[4] Time cost=232.050
INFO:root:Saved checkpoint to "model/3DCE 1 image 3 slice-0005.params"
INFO:root:Validating ...
INFO:root:DeepLesion_val num_images 4793
INFO:root:DeepLesion_val gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_val_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 4793 -> 4791, bboxes: 4889 -> 4887
INFO:root:Loading images with 4 threads.
INFO:root:loading parameters from model/3DCE 1 image 3 slice-0005.params
INFO:root:im_detect: 0/4791 data 0.062s im_detect 0.064s misc 0.002s
INFO:root:im_detect: 200/4791 data 0.005s im_detect 0.046s misc 0.003s
INFO:root:im_detect: 400/4791 data 0.006s im_detect 0.046s misc 0.003s
600 800 1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000 3200 3400 3600 3800 4000 4200 4400 4600
Sensitivity @ [0.5, 1, 2, 4, 8, 16] average FPs per image: [0.36750563 0.47268263 0.5784735  0.67628402 0.75260896 0.8013096 ]
Iter 1: 0.1942
Iter 2: 0.4275
Iter 3: 0.5304
Iter 4: 0.5506
Iter 5: 0.6763
model/3DCE 1 image 3 slice-0004.params deleted to keep only the best model
INFO:root:Validate callback: 0.676284
INFO:root:Returned Validation=0.676284
INFO:root:Retraining data=0.676284
INFO:root:Loading images with 4 threads.
INFO:root:Redoing training to meet criteria = 5
INFO:root:sample boxes filtered, images: 22478 -> 2197, bboxes: 22901 -> 22901
INFO:root:Loading images with 4 threads.
INFO:root:Epoch 5 Batch 0	0.4 smp/sec	RPNLogLoss=0.0512,	RPNL1Loss=0.00747,	RCNNLogLoss=0.255,	RCNNL1Loss=0.0715,	
INFO:root:Update[11326]: Change learning rate to 1.00000e-05
INFO:root:Epoch 5 Batch 100	9.6 smp/sec	RPNLogLoss=0.0444,	RPNL1Loss=0.00791,	RCNNLogLoss=0.247,	RCNNL1Loss=0.0708,	
INFO:root:Epoch 5 Batch 200	9.5 smp/sec	RPNLogLoss=0.0463,	RPNL1Loss=0.00809,	RCNNLogLoss=0.242,	RCNNL1Loss=0.072,	
INFO:root:Epoch 5 Batch 300	9.5 smp/sec	RPNLogLoss=0.0605,	RPNL1Loss=0.0104,	RCNNLogLoss=0.301,	RCNNL1Loss=0.0842,	
INFO:root:Epoch 5 Batch 400	9.9 smp/sec	RPNLogLoss=0.0545,	RPNL1Loss=0.0104,	RCNNLogLoss=0.28,	RCNNL1Loss=0.0734,	
INFO:root:Epoch 5 Batch 500	9.6 smp/sec	RPNLogLoss=0.0553,	RPNL1Loss=0.0137,	RCNNLogLoss=0.25,	RCNNL1Loss=0.0773,	
INFO:root:Epoch 5 Batch 600	9.8 smp/sec	RPNLogLoss=0.056,	RPNL1Loss=0.0102,	RCNNLogLoss=0.287,	RCNNL1Loss=0.0786,	
INFO:root:Epoch 5 Batch 700	9.6 smp/sec	RPNLogLoss=0.053,	RPNL1Loss=0.0123,	RCNNLogLoss=0.221,	RCNNL1Loss=0.072,	
INFO:root:Epoch 5 Batch 800	9.7 smp/sec	RPNLogLoss=0.0295,	RPNL1Loss=0.00989,	RCNNLogLoss=0.225,	RCNNL1Loss=0.0695,	
INFO:root:Epoch 5 Batch 900	9.8 smp/sec	RPNLogLoss=0.047,	RPNL1Loss=0.00859,	RCNNLogLoss=0.239,	RCNNL1Loss=0.0726,	
INFO:root:Epoch 5 Batch 1000	9.8 smp/sec	RPNLogLoss=0.0506,	RPNL1Loss=0.00697,	RCNNLogLoss=0.223,	RCNNL1Loss=0.067,	
INFO:root:Epoch 5 Batch 1100	9.8 smp/sec	RPNLogLoss=0.0562,	RPNL1Loss=0.0124,	RCNNLogLoss=0.256,	RCNNL1Loss=0.0783,	
INFO:root:Epoch 5 Batch 1200	9.5 smp/sec	RPNLogLoss=0.0324,	RPNL1Loss=0.00676,	RCNNLogLoss=0.229,	RCNNL1Loss=0.0622,	
INFO:root:Epoch 5 Batch 1300	9.7 smp/sec	RPNLogLoss=0.0395,	RPNL1Loss=0.00749,	RCNNLogLoss=0.247,	RCNNL1Loss=0.0735,	
INFO:root:Epoch 5 Batch 1400	9.6 smp/sec	RPNLogLoss=0.0455,	RPNL1Loss=0.011,	RCNNLogLoss=0.246,	RCNNL1Loss=0.0796,	
INFO:root:Epoch 5 Batch 1500	9.5 smp/sec	RPNLogLoss=0.0277,	RPNL1Loss=0.00803,	RCNNLogLoss=0.212,	RCNNL1Loss=0.0733,	
INFO:root:Epoch 5 Batch 1600	9.6 smp/sec	RPNLogLoss=0.062,	RPNL1Loss=0.0126,	RCNNLogLoss=0.229,	RCNNL1Loss=0.0693,	
INFO:root:Epoch 5 Batch 1700	9.5 smp/sec	RPNLogLoss=0.0535,	RPNL1Loss=0.00924,	RCNNLogLoss=0.266,	RCNNL1Loss=0.0726,	
INFO:root:Epoch 5 Batch 1800	9.6 smp/sec	RPNLogLoss=0.0483,	RPNL1Loss=0.00887,	RCNNLogLoss=0.252,	RCNNL1Loss=0.0682,	
INFO:root:Epoch 5 Batch 1900	9.6 smp/sec	RPNLogLoss=0.0696,	RPNL1Loss=0.0176,	RCNNLogLoss=0.274,	RCNNL1Loss=0.076,	
INFO:root:Epoch 5 Batch 2000	9.8 smp/sec	RPNLogLoss=0.0593,	RPNL1Loss=0.00965,	RCNNLogLoss=0.256,	RCNNL1Loss=0.0721,	
INFO:root:Epoch 5 Batch 2100	9.6 smp/sec	RPNLogLoss=0.0441,	RPNL1Loss=0.0119,	RCNNLogLoss=0.272,	RCNNL1Loss=0.0812,	
INFO:root:Epoch[5] Train-RPNLogLoss=0.071377
INFO:root:Epoch[5] Train-RPNL1Loss=0.025018
INFO:root:Epoch[5] Train-RCNNLogLoss=0.263371
INFO:root:Epoch[5] Train-RCNNL1Loss=0.070805
INFO:root:Epoch[5] Time cost=228.494
INFO:root:Saved checkpoint to "model/3DCE 1 image 3 slice-0006.params"
INFO:root:Validating ...
INFO:root:DeepLesion_val num_images 4793
INFO:root:DeepLesion_val gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_val_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 4793 -> 4791, bboxes: 4889 -> 4887
INFO:root:Loading images with 4 threads.
INFO:root:loading parameters from model/3DCE 1 image 3 slice-0006.params
INFO:root:im_detect: 0/4791 data 0.022s im_detect 0.059s misc 0.003s
INFO:root:im_detect: 200/4791 data 0.011s im_detect 0.047s misc 0.003s
INFO:root:im_detect: 400/4791 data 0.009s im_detect 0.046s misc 0.003s
600 800 1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000 3200 3400 3600 3800 4000 4200 4400 4600
Sensitivity @ [0.5, 1, 2, 4, 8, 16] average FPs per image: [0.3773276  0.48107223 0.58952322 0.6836505  0.75936157 0.80785758]
Iter 1: 0.1942
Iter 2: 0.4275
Iter 3: 0.5304
Iter 4: 0.5506
Iter 5: 0.6763
Iter 6: 0.6837
model/3DCE 1 image 3 slice-0005.params deleted to keep only the best model
INFO:root:Validate callback: 0.683651
INFO:root:Returned Validation=0.683651
INFO:root:Retraining data=0.683651
INFO:root:Loading images with 4 threads.
INFO:root:Redoing training to meet criteria = 6
INFO:root:sample boxes filtered, images: 22478 -> 2307, bboxes: 22901 -> 22901
INFO:root:Loading images with 4 threads.
INFO:root:Epoch 6 Batch 0	0.3 smp/sec	RPNLogLoss=0.071,	RPNL1Loss=0.0249,	RCNNLogLoss=0.261,	RCNNL1Loss=0.0702,	
INFO:root:Epoch 6 Batch 100	9.3 smp/sec	RPNLogLoss=0.0417,	RPNL1Loss=0.00904,	RCNNLogLoss=0.248,	RCNNL1Loss=0.0745,	
INFO:root:Epoch 6 Batch 200	9.5 smp/sec	RPNLogLoss=0.0413,	RPNL1Loss=0.00636,	RCNNLogLoss=0.262,	RCNNL1Loss=0.0732,	
INFO:root:Epoch 6 Batch 300	9.8 smp/sec	RPNLogLoss=0.051,	RPNL1Loss=0.0138,	RCNNLogLoss=0.255,	RCNNL1Loss=0.0761,	
INFO:root:Epoch 6 Batch 400	9.5 smp/sec	RPNLogLoss=0.0375,	RPNL1Loss=0.00677,	RCNNLogLoss=0.228,	RCNNL1Loss=0.0727,	
INFO:root:Epoch 6 Batch 500	9.4 smp/sec	RPNLogLoss=0.0459,	RPNL1Loss=0.0115,	RCNNLogLoss=0.248,	RCNNL1Loss=0.0754,	
INFO:root:Epoch 6 Batch 600	9.8 smp/sec	RPNLogLoss=0.0619,	RPNL1Loss=0.0118,	RCNNLogLoss=0.235,	RCNNL1Loss=0.0729,	
INFO:root:Epoch 6 Batch 700	9.5 smp/sec	RPNLogLoss=0.0437,	RPNL1Loss=0.0116,	RCNNLogLoss=0.258,	RCNNL1Loss=0.0725,	
INFO:root:Epoch 6 Batch 800	9.6 smp/sec	RPNLogLoss=0.0592,	RPNL1Loss=0.0216,	RCNNLogLoss=0.279,	RCNNL1Loss=0.0752,	
INFO:root:Epoch 6 Batch 900	9.8 smp/sec	RPNLogLoss=0.0607,	RPNL1Loss=0.0137,	RCNNLogLoss=0.255,	RCNNL1Loss=0.0786,	
INFO:root:Epoch 6 Batch 1000	9.5 smp/sec	RPNLogLoss=0.0397,	RPNL1Loss=0.0102,	RCNNLogLoss=0.259,	RCNNL1Loss=0.0735,	
INFO:root:Epoch 6 Batch 1100	9.6 smp/sec	RPNLogLoss=0.0585,	RPNL1Loss=0.00985,	RCNNLogLoss=0.288,	RCNNL1Loss=0.0783,	
INFO:root:Epoch 6 Batch 1200	9.3 smp/sec	RPNLogLoss=0.0707,	RPNL1Loss=0.00952,	RCNNLogLoss=0.271,	RCNNL1Loss=0.0766,	
INFO:root:Epoch 6 Batch 1300	9.6 smp/sec	RPNLogLoss=0.0592,	RPNL1Loss=0.0132,	RCNNLogLoss=0.267,	RCNNL1Loss=0.0722,	
INFO:root:Epoch 6 Batch 1400	9.7 smp/sec	RPNLogLoss=0.0571,	RPNL1Loss=0.00931,	RCNNLogLoss=0.26,	RCNNL1Loss=0.0678,	
INFO:root:Epoch 6 Batch 1500	9.4 smp/sec	RPNLogLoss=0.0488,	RPNL1Loss=0.00915,	RCNNLogLoss=0.274,	RCNNL1Loss=0.0818,	
INFO:root:Epoch 6 Batch 1600	9.7 smp/sec	RPNLogLoss=0.0554,	RPNL1Loss=0.0086,	RCNNLogLoss=0.25,	RCNNL1Loss=0.075,	
INFO:root:Epoch 6 Batch 1700	9.9 smp/sec	RPNLogLoss=0.0549,	RPNL1Loss=0.0103,	RCNNLogLoss=0.246,	RCNNL1Loss=0.0709,	
INFO:root:Epoch 6 Batch 1800	9.4 smp/sec	RPNLogLoss=0.0377,	RPNL1Loss=0.00971,	RCNNLogLoss=0.233,	RCNNL1Loss=0.0707,	
INFO:root:Epoch 6 Batch 1900	9.5 smp/sec	RPNLogLoss=0.0522,	RPNL1Loss=0.0121,	RCNNLogLoss=0.232,	RCNNL1Loss=0.0725,	
INFO:root:Epoch 6 Batch 2000	9.8 smp/sec	RPNLogLoss=0.0444,	RPNL1Loss=0.0122,	RCNNLogLoss=0.241,	RCNNL1Loss=0.0695,	
INFO:root:Epoch 6 Batch 2100	9.7 smp/sec	RPNLogLoss=0.0436,	RPNL1Loss=0.0127,	RCNNLogLoss=0.224,	RCNNL1Loss=0.0649,	
INFO:root:Epoch 6 Batch 2200	9.6 smp/sec	RPNLogLoss=0.061,	RPNL1Loss=0.00847,	RCNNLogLoss=0.268,	RCNNL1Loss=0.0722,	
INFO:root:Epoch 6 Batch 2300	9.9 smp/sec	RPNLogLoss=0.0391,	RPNL1Loss=0.00726,	RCNNLogLoss=0.24,	RCNNL1Loss=0.0691,	
INFO:root:Epoch[6] Train-RPNLogLoss=0.038846
INFO:root:Epoch[6] Train-RPNL1Loss=0.007279
INFO:root:Epoch[6] Train-RCNNLogLoss=0.230871
INFO:root:Epoch[6] Train-RCNNL1Loss=0.068944
INFO:root:Epoch[6] Time cost=241.146
INFO:root:Saved checkpoint to "model/3DCE 1 image 3 slice-0007.params"
INFO:root:Validating ...
INFO:root:DeepLesion_val num_images 4793
INFO:root:DeepLesion_val gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_val_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 4793 -> 4791, bboxes: 4889 -> 4887
INFO:root:Loading images with 4 threads.
INFO:root:loading parameters from model/3DCE 1 image 3 slice-0007.params
INFO:root:im_detect: 0/4791 data 0.003s im_detect 0.082s misc 0.002s
INFO:root:im_detect: 200/4791 data 0.010s im_detect 0.048s misc 0.003s
INFO:root:im_detect: 400/4791 data 0.009s im_detect 0.048s misc 0.003s
600 800 1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000 3200 3400 3600 3800 4000 4200 4400 4600
Sensitivity @ [0.5, 1, 2, 4, 8, 16] average FPs per image: [0.3806016  0.48270923 0.59177409 0.68467362 0.75977082 0.8096992 ]
Iter 1: 0.1942
Iter 2: 0.4275
Iter 3: 0.5304
Iter 4: 0.5506
Iter 5: 0.6763
Iter 6: 0.6837
Iter 7: 0.6847
model/3DCE 1 image 3 slice-0006.params deleted to keep only the best model
INFO:root:Validate callback: 0.684674
INFO:root:Returned Validation=0.684674
INFO:root:Retraining data=0.684674
INFO:root:Loading images with 4 threads.
INFO:root:Redoing training to meet criteria = 7
INFO:root:sample boxes filtered, images: 22478 -> 2235, bboxes: 22901 -> 22901
INFO:root:Loading images with 4 threads.
INFO:root:Epoch 7 Batch 0	0.4 smp/sec	RPNLogLoss=0.0389,	RPNL1Loss=0.00728,	RCNNLogLoss=0.233,	RCNNL1Loss=0.0696,	
INFO:root:Epoch 7 Batch 100	9.6 smp/sec	RPNLogLoss=0.0445,	RPNL1Loss=0.00682,	RCNNLogLoss=0.27,	RCNNL1Loss=0.0777,	
INFO:root:Epoch 7 Batch 200	9.5 smp/sec	RPNLogLoss=0.0479,	RPNL1Loss=0.011,	RCNNLogLoss=0.26,	RCNNL1Loss=0.0797,	
INFO:root:Epoch 7 Batch 300	9.7 smp/sec	RPNLogLoss=0.0499,	RPNL1Loss=0.0102,	RCNNLogLoss=0.247,	RCNNL1Loss=0.0782,	
INFO:root:Epoch 7 Batch 400	9.6 smp/sec	RPNLogLoss=0.0483,	RPNL1Loss=0.00839,	RCNNLogLoss=0.262,	RCNNL1Loss=0.0738,	
INFO:root:Epoch 7 Batch 500	9.6 smp/sec	RPNLogLoss=0.0439,	RPNL1Loss=0.00957,	RCNNLogLoss=0.232,	RCNNL1Loss=0.0736,	
INFO:root:Epoch 7 Batch 600	9.6 smp/sec	RPNLogLoss=0.0508,	RPNL1Loss=0.0109,	RCNNLogLoss=0.232,	RCNNL1Loss=0.0701,	
INFO:root:Epoch 7 Batch 700	9.5 smp/sec	RPNLogLoss=0.0532,	RPNL1Loss=0.0109,	RCNNLogLoss=0.262,	RCNNL1Loss=0.0753,	
INFO:root:Epoch 7 Batch 800	9.9 smp/sec	RPNLogLoss=0.05,	RPNL1Loss=0.00913,	RCNNLogLoss=0.249,	RCNNL1Loss=0.0783,	
INFO:root:Epoch 7 Batch 900	9.7 smp/sec	RPNLogLoss=0.0498,	RPNL1Loss=0.00719,	RCNNLogLoss=0.276,	RCNNL1Loss=0.0744,	
INFO:root:Epoch 7 Batch 1000	9.6 smp/sec	RPNLogLoss=0.0522,	RPNL1Loss=0.00724,	RCNNLogLoss=0.264,	RCNNL1Loss=0.0757,	
INFO:root:Epoch 7 Batch 1100	9.4 smp/sec	RPNLogLoss=0.056,	RPNL1Loss=0.0103,	RCNNLogLoss=0.262,	RCNNL1Loss=0.0712,	
INFO:root:Epoch 7 Batch 1200	9.4 smp/sec	RPNLogLoss=0.053,	RPNL1Loss=0.00984,	RCNNLogLoss=0.243,	RCNNL1Loss=0.0686,	
INFO:root:Epoch 7 Batch 1300	9.6 smp/sec	RPNLogLoss=0.0406,	RPNL1Loss=0.0137,	RCNNLogLoss=0.253,	RCNNL1Loss=0.0745,	
INFO:root:Epoch 7 Batch 1400	9.5 smp/sec	RPNLogLoss=0.0615,	RPNL1Loss=0.00966,	RCNNLogLoss=0.272,	RCNNL1Loss=0.0767,	
INFO:root:Epoch 7 Batch 1500	9.7 smp/sec	RPNLogLoss=0.0361,	RPNL1Loss=0.00893,	RCNNLogLoss=0.234,	RCNNL1Loss=0.0736,	
INFO:root:Epoch 7 Batch 1600	9.7 smp/sec	RPNLogLoss=0.0504,	RPNL1Loss=0.00617,	RCNNLogLoss=0.248,	RCNNL1Loss=0.0772,	
INFO:root:Epoch 7 Batch 1700	9.7 smp/sec	RPNLogLoss=0.0435,	RPNL1Loss=0.0107,	RCNNLogLoss=0.244,	RCNNL1Loss=0.0758,	
INFO:root:Epoch 7 Batch 1800	9.7 smp/sec	RPNLogLoss=0.0484,	RPNL1Loss=0.0111,	RCNNLogLoss=0.253,	RCNNL1Loss=0.0797,	
INFO:root:Epoch 7 Batch 1900	9.6 smp/sec	RPNLogLoss=0.0531,	RPNL1Loss=0.0116,	RCNNLogLoss=0.258,	RCNNL1Loss=0.076,	
INFO:root:Epoch 7 Batch 2000	9.6 smp/sec	RPNLogLoss=0.0414,	RPNL1Loss=0.00958,	RCNNLogLoss=0.222,	RCNNL1Loss=0.0728,	
INFO:root:Epoch 7 Batch 2100	9.7 smp/sec	RPNLogLoss=0.0324,	RPNL1Loss=0.00658,	RCNNLogLoss=0.211,	RCNNL1Loss=0.0718,	
INFO:root:Epoch 7 Batch 2200	9.6 smp/sec	RPNLogLoss=0.0544,	RPNL1Loss=0.0133,	RCNNLogLoss=0.218,	RCNNL1Loss=0.0746,	
INFO:root:Epoch[7] Train-RPNLogLoss=0.053893
INFO:root:Epoch[7] Train-RPNL1Loss=0.013801
INFO:root:Epoch[7] Train-RCNNLogLoss=0.232604
INFO:root:Epoch[7] Train-RCNNL1Loss=0.075874
INFO:root:Epoch[7] Time cost=233.123
INFO:root:Saved checkpoint to "model/3DCE 1 image 3 slice-0008.params"
INFO:root:Validating ...
INFO:root:DeepLesion_val num_images 4793
INFO:root:DeepLesion_val gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_val_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 4793 -> 4791, bboxes: 4889 -> 4887
INFO:root:Loading images with 4 threads.
INFO:root:loading parameters from model/3DCE 1 image 3 slice-0008.params
INFO:root:im_detect: 0/4791 data 0.064s im_detect 0.075s misc 0.003s
INFO:root:im_detect: 200/4791 data 0.008s im_detect 0.050s misc 0.003s
INFO:root:im_detect: 400/4791 data 0.008s im_detect 0.049s misc 0.003s
600 800 1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000 3200 3400 3600 3800 4000 4200 4400 4600
Sensitivity @ [0.5, 1, 2, 4, 8, 16] average FPs per image: [0.38326171 0.48843871 0.59361572 0.68876611 0.76284019 0.81358707]
Iter 1: 0.1942
Iter 2: 0.4275
Iter 3: 0.5304
Iter 4: 0.5506
Iter 5: 0.6763
Iter 6: 0.6837
Iter 7: 0.6847
Iter 8: 0.6888
model/3DCE 1 image 3 slice-0007.params deleted to keep only the best model
INFO:root:Validate callback: 0.688766
INFO:root:Returned Validation=0.688766
INFO:root:Retraining data=0.688766
INFO:root:Loading images with 4 threads.
INFO:root:Redoing training to meet criteria = 8
INFO:root:sample boxes filtered, images: 22478 -> 2265, bboxes: 22901 -> 22901
INFO:root:Loading images with 4 threads.
INFO:root:Epoch 8 Batch 0	0.3 smp/sec	RPNLogLoss=0.0541,	RPNL1Loss=0.0137,	RCNNLogLoss=0.233,	RCNNL1Loss=0.0754,	
INFO:root:Epoch 8 Batch 100	9.4 smp/sec	RPNLogLoss=0.0529,	RPNL1Loss=0.00879,	RCNNLogLoss=0.263,	RCNNL1Loss=0.0747,	
INFO:root:Epoch 8 Batch 200	9.4 smp/sec	RPNLogLoss=0.0691,	RPNL1Loss=0.0145,	RCNNLogLoss=0.259,	RCNNL1Loss=0.0717,	
INFO:root:Epoch 8 Batch 300	9.5 smp/sec	RPNLogLoss=0.0414,	RPNL1Loss=0.00839,	RCNNLogLoss=0.239,	RCNNL1Loss=0.0706,	
INFO:root:Epoch 8 Batch 400	9.5 smp/sec	RPNLogLoss=0.062,	RPNL1Loss=0.00968,	RCNNLogLoss=0.289,	RCNNL1Loss=0.0851,	
INFO:root:Epoch 8 Batch 500	9.5 smp/sec	RPNLogLoss=0.0433,	RPNL1Loss=0.0112,	RCNNLogLoss=0.214,	RCNNL1Loss=0.0676,	
INFO:root:Epoch 8 Batch 600	9.6 smp/sec	RPNLogLoss=0.0452,	RPNL1Loss=0.0098,	RCNNLogLoss=0.26,	RCNNL1Loss=0.0784,	
INFO:root:Epoch 8 Batch 700	9.6 smp/sec	RPNLogLoss=0.0547,	RPNL1Loss=0.0129,	RCNNLogLoss=0.226,	RCNNL1Loss=0.0746,	
INFO:root:Epoch 8 Batch 800	9.5 smp/sec	RPNLogLoss=0.053,	RPNL1Loss=0.00896,	RCNNLogLoss=0.233,	RCNNL1Loss=0.0792,	
INFO:root:Epoch 8 Batch 900	9.5 smp/sec	RPNLogLoss=0.0618,	RPNL1Loss=0.0116,	RCNNLogLoss=0.273,	RCNNL1Loss=0.0836,	
INFO:root:Epoch 8 Batch 1000	9.6 smp/sec	RPNLogLoss=0.0504,	RPNL1Loss=0.00844,	RCNNLogLoss=0.264,	RCNNL1Loss=0.0648,	
INFO:root:Epoch 8 Batch 1100	9.3 smp/sec	RPNLogLoss=0.0449,	RPNL1Loss=0.00906,	RCNNLogLoss=0.234,	RCNNL1Loss=0.0586,	
INFO:root:Epoch 8 Batch 1200	9.5 smp/sec	RPNLogLoss=0.0376,	RPNL1Loss=0.00712,	RCNNLogLoss=0.23,	RCNNL1Loss=0.0717,	
INFO:root:Epoch 8 Batch 1300	10.0 smp/sec	RPNLogLoss=0.0398,	RPNL1Loss=0.00857,	RCNNLogLoss=0.222,	RCNNL1Loss=0.0647,	
INFO:root:Epoch 8 Batch 1400	9.9 smp/sec	RPNLogLoss=0.0574,	RPNL1Loss=0.00885,	RCNNLogLoss=0.244,	RCNNL1Loss=0.0729,	
INFO:root:Epoch 8 Batch 1500	9.8 smp/sec	RPNLogLoss=0.0353,	RPNL1Loss=0.00876,	RCNNLogLoss=0.219,	RCNNL1Loss=0.0653,	
INFO:root:Epoch 8 Batch 1600	10.0 smp/sec	RPNLogLoss=0.0453,	RPNL1Loss=0.0117,	RCNNLogLoss=0.226,	RCNNL1Loss=0.0656,	
INFO:root:Epoch 8 Batch 1700	9.8 smp/sec	RPNLogLoss=0.0389,	RPNL1Loss=0.0072,	RCNNLogLoss=0.22,	RCNNL1Loss=0.0674,	
INFO:root:Epoch 8 Batch 1800	9.9 smp/sec	RPNLogLoss=0.0438,	RPNL1Loss=0.0103,	RCNNLogLoss=0.231,	RCNNL1Loss=0.0725,	
INFO:root:Epoch 8 Batch 1900	9.8 smp/sec	RPNLogLoss=0.0454,	RPNL1Loss=0.00922,	RCNNLogLoss=0.265,	RCNNL1Loss=0.0711,	
INFO:root:Epoch 8 Batch 2000	9.4 smp/sec	RPNLogLoss=0.0548,	RPNL1Loss=0.0117,	RCNNLogLoss=0.255,	RCNNL1Loss=0.0748,	
INFO:root:Epoch 8 Batch 2100	9.9 smp/sec	RPNLogLoss=0.0504,	RPNL1Loss=0.011,	RCNNLogLoss=0.249,	RCNNL1Loss=0.0709,	
INFO:root:Epoch 8 Batch 2200	9.5 smp/sec	RPNLogLoss=0.0408,	RPNL1Loss=0.0126,	RCNNLogLoss=0.222,	RCNNL1Loss=0.0684,	
INFO:root:Epoch[8] Train-RPNLogLoss=0.061303
INFO:root:Epoch[8] Train-RPNL1Loss=0.012389
INFO:root:Epoch[8] Train-RCNNLogLoss=0.243281
INFO:root:Epoch[8] Train-RCNNL1Loss=0.076497
INFO:root:Epoch[8] Time cost=236.018
INFO:root:Saved checkpoint to "model/3DCE 1 image 3 slice-0009.params"
INFO:root:Validating ...
INFO:root:DeepLesion_val num_images 4793
INFO:root:DeepLesion_val gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_val_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 4793 -> 4791, bboxes: 4889 -> 4887
INFO:root:Loading images with 4 threads.
INFO:root:loading parameters from model/3DCE 1 image 3 slice-0009.params
INFO:root:im_detect: 0/4791 data 0.047s im_detect 0.052s misc 0.003s
INFO:root:im_detect: 200/4791 data 0.008s im_detect 0.046s misc 0.003s
INFO:root:im_detect: 400/4791 data 0.009s im_detect 0.047s misc 0.003s
600 800 1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000 3200 3400 3600 3800 4000 4200 4400 4600
Sensitivity @ [0.5, 1, 2, 4, 8, 16] average FPs per image: [0.38674033 0.49130346 0.5993452  0.68978924 0.76284019 0.81092695]
Iter 1: 0.1942
Iter 2: 0.4275
Iter 3: 0.5304
Iter 4: 0.5506
Iter 5: 0.6763
Iter 6: 0.6837
Iter 7: 0.6847
Iter 8: 0.6888
Iter 9: 0.6898
model/3DCE 1 image 3 slice-0008.params deleted to keep only the best model
INFO:root:Validate callback: 0.689789
INFO:root:Returned Validation=0.689789
INFO:root:Retraining data=0.689789
INFO:root:Loading images with 4 threads.
INFO:root:Redoing training to meet criteria = 9
INFO:root:sample boxes filtered, images: 22478 -> 2177, bboxes: 22901 -> 22901
INFO:root:Loading images with 4 threads.
INFO:root:Epoch 9 Batch 0	0.3 smp/sec	RPNLogLoss=0.0614,	RPNL1Loss=0.0124,	RCNNLogLoss=0.242,	RCNNL1Loss=0.076,	
INFO:root:Epoch 9 Batch 100	9.5 smp/sec	RPNLogLoss=0.0496,	RPNL1Loss=0.00779,	RCNNLogLoss=0.246,	RCNNL1Loss=0.072,	
INFO:root:Epoch 9 Batch 200	9.7 smp/sec	RPNLogLoss=0.0424,	RPNL1Loss=0.00683,	RCNNLogLoss=0.244,	RCNNL1Loss=0.0732,	
INFO:root:Epoch 9 Batch 300	9.6 smp/sec	RPNLogLoss=0.0618,	RPNL1Loss=0.0126,	RCNNLogLoss=0.274,	RCNNL1Loss=0.0762,	
INFO:root:Epoch 9 Batch 400	10.1 smp/sec	RPNLogLoss=0.0463,	RPNL1Loss=0.00725,	RCNNLogLoss=0.202,	RCNNL1Loss=0.0728,	
INFO:root:Epoch 9 Batch 500	9.6 smp/sec	RPNLogLoss=0.0381,	RPNL1Loss=0.00745,	RCNNLogLoss=0.23,	RCNNL1Loss=0.0677,	
INFO:root:Epoch 9 Batch 600	9.5 smp/sec	RPNLogLoss=0.0665,	RPNL1Loss=0.0245,	RCNNLogLoss=0.223,	RCNNL1Loss=0.066,	
INFO:root:Epoch 9 Batch 700	9.6 smp/sec	RPNLogLoss=0.0579,	RPNL1Loss=0.0142,	RCNNLogLoss=0.252,	RCNNL1Loss=0.0792,	
INFO:root:Epoch 9 Batch 800	9.7 smp/sec	RPNLogLoss=0.0541,	RPNL1Loss=0.00725,	RCNNLogLoss=0.263,	RCNNL1Loss=0.0725,	
INFO:root:Epoch 9 Batch 900	9.6 smp/sec	RPNLogLoss=0.0465,	RPNL1Loss=0.00946,	RCNNLogLoss=0.273,	RCNNL1Loss=0.0779,	
INFO:root:Epoch 9 Batch 1000	9.5 smp/sec	RPNLogLoss=0.0459,	RPNL1Loss=0.00901,	RCNNLogLoss=0.237,	RCNNL1Loss=0.067,	
INFO:root:Epoch 9 Batch 1100	9.4 smp/sec	RPNLogLoss=0.0413,	RPNL1Loss=0.00653,	RCNNLogLoss=0.225,	RCNNL1Loss=0.0705,	
INFO:root:Epoch 9 Batch 1200	9.5 smp/sec	RPNLogLoss=0.0623,	RPNL1Loss=0.0123,	RCNNLogLoss=0.294,	RCNNL1Loss=0.0808,	
INFO:root:Epoch 9 Batch 1300	9.3 smp/sec	RPNLogLoss=0.0368,	RPNL1Loss=0.00761,	RCNNLogLoss=0.276,	RCNNL1Loss=0.0766,	
INFO:root:Epoch 9 Batch 1400	9.7 smp/sec	RPNLogLoss=0.0402,	RPNL1Loss=0.0127,	RCNNLogLoss=0.242,	RCNNL1Loss=0.0683,	
INFO:root:Epoch 9 Batch 1500	9.7 smp/sec	RPNLogLoss=0.0371,	RPNL1Loss=0.0121,	RCNNLogLoss=0.244,	RCNNL1Loss=0.0693,	
INFO:root:Epoch 9 Batch 1600	9.7 smp/sec	RPNLogLoss=0.0496,	RPNL1Loss=0.0101,	RCNNLogLoss=0.258,	RCNNL1Loss=0.0812,	
INFO:root:Epoch 9 Batch 1700	9.4 smp/sec	RPNLogLoss=0.0511,	RPNL1Loss=0.00771,	RCNNLogLoss=0.282,	RCNNL1Loss=0.0787,	
INFO:root:Epoch 9 Batch 1800	9.6 smp/sec	RPNLogLoss=0.0539,	RPNL1Loss=0.00818,	RCNNLogLoss=0.252,	RCNNL1Loss=0.0747,	
INFO:root:Epoch 9 Batch 1900	9.8 smp/sec	RPNLogLoss=0.0467,	RPNL1Loss=0.0101,	RCNNLogLoss=0.229,	RCNNL1Loss=0.0754,	
INFO:root:Epoch 9 Batch 2000	9.8 smp/sec	RPNLogLoss=0.0572,	RPNL1Loss=0.0102,	RCNNLogLoss=0.257,	RCNNL1Loss=0.0721,	
INFO:root:Epoch 9 Batch 2100	9.6 smp/sec	RPNLogLoss=0.0532,	RPNL1Loss=0.0116,	RCNNLogLoss=0.247,	RCNNL1Loss=0.0718,	
INFO:root:Epoch[9] Train-RPNLogLoss=0.045165
INFO:root:Epoch[9] Train-RPNL1Loss=0.011009
INFO:root:Epoch[9] Train-RCNNLogLoss=0.254527
INFO:root:Epoch[9] Train-RCNNL1Loss=0.077875
INFO:root:Epoch[9] Time cost=227.272
INFO:root:Saved checkpoint to "model/3DCE 1 image 3 slice-0010.params"
INFO:root:Validating ...
INFO:root:DeepLesion_val num_images 4793
INFO:root:DeepLesion_val gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_val_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 4793 -> 4791, bboxes: 4889 -> 4887
INFO:root:Loading images with 4 threads.
INFO:root:loading parameters from model/3DCE 1 image 3 slice-0010.params
INFO:root:im_detect: 0/4791 data 0.030s im_detect 0.067s misc 0.002s
INFO:root:im_detect: 200/4791 data 0.006s im_detect 0.048s misc 0.003s
INFO:root:im_detect: 400/4791 data 0.008s im_detect 0.048s misc 0.003s
600 800 1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000 3200 3400 3600 3800 4000 4200 4400 4600
Sensitivity @ [0.5, 1, 2, 4, 8, 16] average FPs per image: [0.38326171 0.4941682  0.59995908 0.6928586  0.7671373  0.81542869]
Iter 1: 0.1942
Iter 2: 0.4275
Iter 3: 0.5304
Iter 4: 0.5506
Iter 5: 0.6763
Iter 6: 0.6837
Iter 7: 0.6847
Iter 8: 0.6888
Iter 9: 0.6898
Iter 10: 0.6929
model/3DCE 1 image 3 slice-0009.params deleted to keep only the best model
INFO:root:Validate callback: 0.692859
INFO:root:Returned Validation=0.692859
INFO:root:Retraining data=0.692859
INFO:root:Loading images with 4 threads.
INFO:root:Testing ...
INFO:root:DeepLesion_test num_images 4831
INFO:root:DeepLesion_test gt roidb loaded from /home/pulido/CADLab/lesion_detector_3DCE/images/cache/DeepLesion_test_gt_roidb.pkl
INFO:root:noisy boxes filtered, images: 4831 -> 4817, bboxes: 4927 -> 4912
INFO:root:Loading images with 4 threads.
INFO:root:loading parameters from model/3DCE 1 image 3 slice-0010.params
INFO:root:im_detect: 0/4817 data 0.046s im_detect 0.046s misc 0.011s
INFO:root:im_detect: 200/4817 data 0.006s im_detect 0.055s misc 0.003s
INFO:root:im_detect: 400/4817 data 0.006s im_detect 0.053s misc 0.003s
600 800 1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000 3200 3400 3600 3800 4000 4200 4400 4600 4800
Sensitivity @ [0.5, 1, 2, 4, 8, 16] average FPs per image: [0.38650244 0.49898208 0.60525244 0.69991857 0.77666938 0.82369707]
